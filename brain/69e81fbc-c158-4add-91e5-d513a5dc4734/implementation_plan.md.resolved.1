# Thiáº¿t káº¿ MÃ n HÃ¬nh Streak - Chuá»—i Há»c Táº­p ğŸ”¥

Táº¡o tÃ­nh nÄƒng Streak hoÃ n chá»‰nh: icon Ngá»n lá»­a thay Ä‘á»•i tráº¡ng thÃ¡i (xÃ¡m/cam), mÃ n hÃ¬nh Streak vá»›i Hero Animation, lá»‹ch tuáº§n, vÃ  logic kiá»ƒm tra chuá»—i tá»± Ä‘á»™ng.

---

## Proposed Changes

### Service Layer

#### [MODIFY] [progress_service.dart](file:///Users/devsang/Developer/App Learn English/lib/core/services/progress_service.dart)

ThÃªm cÃ¡c thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c má»›i:

- `isStreakActiveToday` (RxBool) â€” Tráº¡ng thÃ¡i Ä‘Ã£ há»c hÃ´m nay chÆ°a
- `weeklyActivityDays` (RxList<String>) â€” Danh sÃ¡ch ngÃ y Ä‘Ã£ há»c trong tuáº§n (ISO format)
- `_keyWeeklyDays` â€” Key lÆ°u SharedPreferences
- `checkDailyStreak()` â€” Public method gá»i khi app resume tá»« background
- Cáº­p nháº­t [updateStreakAndPuzzle()](file:///Users/devsang/Developer/App%20Learn%20English/lib/core/services/progress_service.dart#316-350) Ä‘á»ƒ set `isStreakActiveToday = true` vÃ  ghi vÃ o `weeklyActivityDays`
- Cáº­p nháº­t [_loadProgress()](file:///Users/devsang/Developer/App%20Learn%20English/lib/core/services/progress_service.dart#85-135) Ä‘á»ƒ load `weeklyActivityDays` vÃ  check `isStreakActiveToday`

---

### Controller + Binding

#### [NEW] [streak_controller.dart](file:///Users/devsang/Developer/App Learn English/lib/presentation/controllers/streak_controller.dart)

- Extends `GetxController`
- Láº¥y data tá»« [ProgressService](file:///Users/devsang/Developer/App%20Learn%20English/lib/core/services/progress_service.dart#8-416): `streakCount`, `isActiveToday`, `weeklyDays`
- HÃ m `getWeekDayStatus(int weekday)` â†’ tráº£ vá» `active/inactive/today`
- HÃ m `navigateToHome()` â†’ chuyá»ƒn vá» tab HÃ nh trÃ¬nh
- PhÃ¡t [celebration.mp3](file:///Users/devsang/Developer/App%20Learn%20English/assets/audio/celebration.mp3) khi má»Ÿ screen vÃ  streak vá»«a tÄƒng

#### [NEW] [streak_binding.dart](file:///Users/devsang/Developer/App Learn English/lib/presentation/bindings/streak_binding.dart)

- `lazyPut` â†’ `StreakController`

---

### UI - Streak Screen

#### [NEW] [streak_screen.dart](file:///Users/devsang/Developer/App Learn English/lib/presentation/screens/streak_screen.dart)

Layout tá»« trÃªn xuá»‘ng:

1. **AppBar**: NÃºt back, title "Chuá»—i há»c táº­p"
2. **Hero Flame** (trung tÃ¢m): Container trÃ²n gradient cam-Ä‘á», bÃªn trong cÃ³ `ğŸ”¥` text lá»›n + sá»‘ ngÃ y. Hiá»‡u á»©ng Glow báº±ng `BoxShadow` animated.
3. **Lá»‹ch tuáº§n**: Row 7 vÃ²ng trÃ²n (T2â†’CN). NgÃ y Ä‘Ã£ há»c = ğŸ”¥ nhá»/âœ“ vÃ ng, chÆ°a há»c = vÃ²ng trÃ²n xÃ¡m.
4. **Foxy message**: Bubble tráº¯ng vá»›i text cá»• vÅ©
5. **CTA Button**: NÃºt cam lá»›n "Tiáº¿p tá»¥c há»c ngay" â†’ navigate vá» HÃ nh trÃ¬nh

---

### Integration - Icon Ngá»n Lá»­a

#### [MODIFY] [practice_screen.dart](file:///Users/devsang/Developer/App Learn English/lib/presentation/screens/practice_screen.dart)

- Wrap icon ğŸ”¥ báº±ng `Hero(tag: 'streak_icon')`
- ThÃªm `GestureDetector` â†’ `Get.toNamed('/streak')`
- Äá»•i mÃ u dá»±a trÃªn `isStreakActiveToday`: active = cam, inactive = xÃ¡m
- ThÃªm `AnimatedSwitcher` cho hiá»‡u á»©ng chuyá»ƒn mÃ u

#### [MODIFY] [home_screen.dart](file:///Users/devsang/Developer/App Learn English/lib/presentation/screens/home_screen.dart)

- ThÃªm icon ğŸ”¥ nhá» bÃªn cáº¡nh star count trong header
- `GestureDetector` â†’ `Get.toNamed('/streak')`
- Äá»•i mÃ u dá»±a trÃªn `isStreakActiveToday`

---

### Routing

#### [MODIFY] [app_routes.dart](file:///Users/devsang/Developer/App Learn English/lib/routes/app_routes.dart)

- ThÃªm `static const streak = '/streak';`

#### [MODIFY] [app_pages.dart](file:///Users/devsang/Developer/App Learn English/lib/routes/app_pages.dart)

- ThÃªm `GetPage` cho `/streak` vá»›i `StreakBinding` vÃ  `Hero` transition

---

## Verification Plan

### Automated Tests
- `flutter analyze` â€” KhÃ´ng cÃ³ lá»—i má»›i

### Manual Verification
- Má»Ÿ app â†’ Ngá»n lá»­a xÃ¡m (chÆ°a há»c hÃ´m nay)
- HoÃ n thÃ nh 1 bÃ i â†’ Ngá»n lá»­a chuyá»ƒn cam + toast Foxy
- Nháº¥n icon ğŸ”¥ â†’ Hero animation bay ra giá»¯a â†’ Streak Screen
- Lá»‹ch tuáº§n hiá»ƒn thá»‹ Ä‘Ãºng ngÃ y Ä‘Ã£ há»c
- NÃºt "Tiáº¿p tá»¥c há»c ngay" â†’ vá» HÃ nh trÃ¬nh
